# ============================
#  SkinMatch Environment File
#  Copy this file to `.env`
#  Then fill in all <...> values
# ============================
DJANGO_ENV=development
# Django Security
DJANGO_SECRET_KEY=<CHANGE_ME_DJANGO_SECRET_KEY>
DJANGO_DEBUG=True
DJANGO_SECURE_SSL_REDIRECT=False
DJANGO_SESSION_COOKIE_SECURE=False
DJANGO_CSRF_COOKIE_SECURE=False
DJANGO_SESSION_COOKIE_HTTPONLY=True
DJANGO_CSRF_COOKIE_HTTPONLY=True
DJANGO_SESSION_COOKIE_SAMESITE=Lax
DJANGO_CSRF_COOKIE_SAMESITE=Lax
DJANGO_SESSION_COOKIE_AGE=14400
DJANGO_SESSION_EXPIRE_AT_BROWSER_CLOSE=False
DJANGO_SESSION_IDLE_TIMEOUT_SECONDS=1800
DJANGO_SESSION_IDLE_TIMEOUT_EXEMPT_PATHS=/healthz/,/accounts/login/
DJANGO_SESSION_TIMEOUT_API_PREFIXES=/api/
DJANGO_SESSION_TIMEOUT_REDIRECT_URL=/login?timeout=1
DJANGO_SECURE_HSTS_SECONDS=0
DJANGO_SECURE_HSTS_INCLUDE_SUBDOMAINS=False
DJANGO_SECURE_HSTS_PRELOAD=False
DJANGO_SECURE_REFERRER_POLICY=strict-origin-when-cross-origin
DJANGO_X_FRAME_OPTIONS=DENY
DJANGO_USE_PROXY_SSL_HEADER=True
DJANGO_USE_X_FORWARDED_HOST=True

DJANGO_CONTENT_SECURITY_POLICY="default-src 'self'; img-src 'self' data: blob:; media-src 'self' data: blob:; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'"
DJANGO_CSP_REPORT_ONLY=False

FACT_IMAGE_MAX_UPLOAD_MB=5

# Database
DATABASE_URL=postgresql://skinuser:skinpass@localhost:5432/skinmatch

TIME_ZONE=Asia/Bangkok
ALLOWED_HOSTS=localhost,127.0.0.1,backend,192.168.1.117
CSRF_TRUSTED_ORIGINS=http://127.0.0.1:8000,http://0.0.0.0:8000

# Google OAuth Login
GOOGLE_OAUTH_CLIENT_ID=<CHANGE_ME_GOOGLE_CLIENT_ID>
GOOGLE_OAUTH_CLIENT_SECRET=<CHANGE_ME_GOOGLE_CLIENT_SECRET>

# Admin Access
ADMIN_PROTECTED_PATH_PREFIXES=/admin/
ADMIN_ALLOWED_ROLES=admin,staff
ADMIN_ALLOWED_IPS=<Your_Allowed_IPs> # ex. 172.217.194.108
ADMIN_TRUSTED_IP_HEADERS=HTTP_X_FORWARDED_FOR,REMOTE_ADDR
ADMIN_COUNTRY_HEADERS=HTTP_CF_IPCOUNTRY,HTTP_X_APPENGINE_COUNTRY,GEOIP_COUNTRY_CODE
ADMIN_ALLOWED_COUNTRIES=

# API Security
API_REQUIRE_KEY_FOR_ANONYMOUS=False
API_PROTECTED_PATH_PREFIXES=/api/
API_KEY_HEADER=X-API-Key
API_KEY_QUERY_PARAM=api_key
API_RATE_LIMIT_DEFAULT_PER_MIN=300
API_RATE_LIMIT_PER_IP_PER_MIN=600
API_RATE_LIMIT_WINDOW_SECONDS=60
API_MAX_BODY_KB=512
API_INPUT_BLOCKLIST=<script,</script>,union select,drop table,insert into
API_VERSION_DEFAULT=v1
SENSITIVE_PATH_PATTERNS=.env,.env.,/.git,/.git/,/config/,/docker-compose.yaml,/docker-compose.yml,/package-lock.json,/yarn.lock,/xmlrpc.php

# Security Monitoring
SECURITY_ALERT_EMAILS=security@skinmatch.com,devops@skinmatch.com,skinmatch.contact@gmail.com
SECURITY_ALERT_MIN_LEVEL=ERROR
SECURITY_LOG_FILE=
SECURITY_LOG_LEVEL=INFO
SECURITY_FAILED_LOGIN_THRESHOLD=5
SECURITY_FAILED_LOGIN_WINDOW_SECONDS=900
SECURITY_SUSPICIOUS_PATH_KEYWORDS=wp-login,wp-admin,phpmyadmin,.git/,server-status,.env
SECURITY_MONITOR_STATUS_CODES=401,403,404,405
SECURITY_MONITOR_RATE_THRESHOLD=25
SECURITY_MONITOR_RATE_WINDOW_SECONDS=300

# Google API / Gemini
GOOGLE_API_KEY=<CHANGE_ME_GOOGLE_API_KEY>
GOOGLE_GEMINI_MODEL=gemini-1.5-flash

# Email (Gmail SMTP)
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_HOST_USER=<CHANGE_ME_EMAIL>
EMAIL_HOST_PASSWORD=<CHANGE_ME_EMAIL_PASSWORD>
EMAIL_USE_TLS=True
EMAIL_USE_SSL=False
DEFAULT_FROM_EMAIL=SkinMatch <<CHANGE_ME_EMAIL>> # ex. SkinMatch <skinmatch.contact@gmail.com>
